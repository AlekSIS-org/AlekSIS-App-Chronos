{% include 'partials/header.html' %}

<script type="text/javascript">
    function updateDatepicker() {
        $("#date").val(formatDate(activeDate));
    }

    function update() {
        console.log("Render new.");

        updateDatepicker();
    }

    function onDateBeforeClick() {
        activeDate.setDate(activeDate.getDate() - 1);
        update();
    }

    function onDateNextClick() {
        activeDate.setDate(activeDate.getDate() + 1);
        update();
    }

    var activeDate = getNow();

    $(document).ready(function () {
        $("#date-before").click(onDateBeforeClick);
        $("#date-next").click(onDateNextClick);

        // Print the site
        $("#print").click(function () {
            window.print();
        });

        update();
    })
</script>

<main>
    <h3>Vertretungen</h3>

    <div class="row">
        <div class="col s12 m6 l4 xl3">
            <div class="col s2">
                <a class="waves-effect waves-teal btn-flat btn-flat-medium right" id="date-before">
                    <i class="material-icons center">navigate_before</i>
                </a>

            </div>
            <div class="col s8">
                <input type="text" class="datepicker center-align" id="date">
            </div>
            <div class="col s2">
                <a class="waves-effect waves-teal btn-flat btn-flat-medium left" id="date-next">
                    <i class="material-icons center">navigate_next</i>
                </a>
            </div>
        </div>
        <div class="col l4 xl6">
        </div>
        <div class="col s12 m6 l4 xl3 right align-right">
            <a class="waves-effect waves-teal btn-flat btn-flat-medium right" id="print">
                <i class="material-icons center">print</i>
            </a>
        </div>
    </div>

    <p class="flow-text">
        Leider ist der Vertretungsplan noch nicht in Betrieb. Nutzen Sie solange die <a
            href="https://info.katharineum.de/aktuell.pdf">alte Version</a>. Vielen Dank!
    </p>
    <div class="row">
        <div class="col s12 m6">
            <table>
                <thead>
                <tr>
                    <th><i class="material-icons">access_time</i></th>
                    <th><i class="material-icons">people</i></th>
                    <th>Lehrer</th>
                    <th>Fach</th>
                    <th>Raum</th>
                    <th><i class="material-icons">info</i></th>
                    <th>i</th>
                </tr>
                </thead>
                <tbody>
                {% for sub in subs %}
                    <tr>
                        <td>
                            <strong>{{ sub.lesson }}.</strong>
                        </td>
                        <td>
                            {% for class_ in sub.classes %}
                                {{ class_.name }}
                            {% endfor %}
                        </td>
                        <td>
                            {% if sub.teacher_new %}
                                <s>{{ sub.teacher_old.shortcode }}</s> →
                                <strong>{{ sub.teacher_new.shortcode }}</strong>
                            {% else %}
                                <strong>{{ sub.teacher_old.shortcode }}</strong>
                            {% endif %}
                        </td>
                        <td>
                            {% if sub.subject_new %}
                                <s>{{ sub.subject_old.shortcode }}</s> →
                                <strong>{{ sub.subject_new.shortcode }}</strong>
                            {% else %}
                                <strong>{{ sub.subject_old.shortcode }}</strong>
                            {% endif %}
                        </td>
                        <td>
                            {% if sub.room_new %}
                                <s>{{ sub.room_old.shortcode }}</s> → <strong>{{ sub.room_new.shortcode }}</strong>
                            {% else %}
                                <strong>{{ sub.room_old.shortcode }}</strong>
                            {% endif %}
                        </td>
                        <td>
                            <em>{{ sub.text|default:"" }}</em>
                        </td>
                        <td>
                            <small>{{ sub.id }} {{ sub.lesson_id }}</small>
                        </td>
                    </tr>
                    {#        {{ sub.date }}#}
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</main>

{% include 'partials/footer.html' %}
